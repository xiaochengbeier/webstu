<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>canvas 自由落体</title>
</head>

<body>
    <canvas width="500px" height="500px"></canvas>
</body>
<script>
    var canvas = document.getElementsByTagName("canvas")[0];
    var context = canvas.getContext("2d");
    var speed = 0;
    var newSpeed = 0;
    var a = 3;
    var timer = window.setInterval(function() {
        speed += a;
        newSpeed = newSpeed + speed;
        //到底部极限值
        var max = canvas.offsetHeight - 50;

        if (newSpeed >= max) {
            speed *= -1;
            speed *= 0.8;
            newSpeed = max;
        }
        // if (newSpeed <= 0) {
        //     speed *= -1;
        //     speed *= 0.8;
        // }
        if (Math.abs(speed) < 1.5 && newSpeed >= max) {
            clearInterval(timer);
            console.log("over...");
        }
        context.clearRect(0, 0, 500, 500);
        context.fillRect(300, newSpeed, 50, 50);
    }, 1000 / 60);
</script>

</html>